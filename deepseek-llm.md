- [DeepSeek LLM: Scaling Open-Source Language Models with Longtermism](#deepseek-llm-scaling-open-source-language-models-with-longtermism)
  - [èƒŒæ™¯](#èƒŒæ™¯)
  - [1. æ‘˜è¦](#1-æ‘˜è¦)
  - [2. ä»‹ç»](#2-ä»‹ç»)
  - [3. é¢„è®­ç»ƒ](#3-é¢„è®­ç»ƒ)
    - [æ•°æ®é›†](#æ•°æ®é›†)
    - [æ¨¡åž‹ç»“æž„](#æ¨¡åž‹ç»“æž„)
    - [è¶…å‚æ•°ï¼ˆhyperparametersï¼‰](#è¶…å‚æ•°hyperparameters)
    - [åŸºç¡€è®¾æ–½](#åŸºç¡€è®¾æ–½)
    - [ç¼©æ”¾å®šå¾‹(Scaling Laws)](#ç¼©æ”¾å®šå¾‹scaling-laws)
      - [è¶…å‚æ•°çš„ç¼©æ”¾å®šå¾‹ï¼ˆScaling Laws for Hyperparametersï¼‰](#è¶…å‚æ•°çš„ç¼©æ”¾å®šå¾‹scaling-laws-for-hyperparameters)
      - [ä¼°è®¡æœ€ä½³æ¨¡åž‹å’Œæ•°æ®ç¼©æ”¾ï¼ˆEstimating Optimal Model and Data Scalingï¼‰](#ä¼°è®¡æœ€ä½³æ¨¡åž‹å’Œæ•°æ®ç¼©æ”¾estimating-optimal-model-and-data-scaling)
      - [ä¸åŒæ•°æ®çš„ç¼©æ”¾å®šå¾‹ï¼ˆScaling Laws with Different Dataï¼‰](#ä¸åŒæ•°æ®çš„ç¼©æ”¾å®šå¾‹scaling-laws-with-different-data)
  - [4. å¯¹é½](#4-å¯¹é½)
  - [5. è¯„ä¼°ï¼ˆEvaluationï¼‰](#5-è¯„ä¼°evaluation)
    - [å…¬å¼€æµ‹è¯•é›†](#å…¬å¼€æµ‹è¯•é›†)
    - [base model](#base-model)
    - [chat model](#chat-model)
    - [å¼€æ”¾å¼è¯„ä¼°](#å¼€æ”¾å¼è¯„ä¼°)
      - [ä¸­æ–‡å¼€æ”¾å¼è¯„ä¼°](#ä¸­æ–‡å¼€æ”¾å¼è¯„ä¼°)
      - [è‹±æ–‡å¼€æ”¾å¼è¯„ä¼°](#è‹±æ–‡å¼€æ”¾å¼è¯„ä¼°)
      - [held-outè¯„ä¼°](#held-outè¯„ä¼°)
      - [Safety Evaluation](#safety-evaluation)
  - [6. ç»“è®º](#6-ç»“è®º)


# DeepSeek LLM: Scaling Open-Source Language Models with Longtermism

## èƒŒæ™¯
é‡åŒ–å·¨å¤´å¹»æ–¹æŽ¢ç´¢AGIï¼ˆé€šç”¨äººå·¥æ™ºèƒ½ï¼‰æ–°ç»„ç»‡â€œæ·±åº¦æ±‚ç´¢â€åœ¨æˆç«‹åŠå¹´åŽï¼Œå‘å¸ƒçš„ç¬¬ä¸€ä»£å¤§æ¨¡åž‹DeepSeekè¯•ç”¨åœ°å€ï¼š[DeepSeek](https://chat.deepseek.com/sign_in) ï¼Œå…è´¹å•†ç”¨ï¼Œå®Œå…¨å¼€æºã€‚ä½œä¸ºä¸€å®¶éšå½¢çš„AIå·¨å¤´ï¼Œå¹»æ–¹æ‹¥æœ‰1ä¸‡æžšè‹±ä¼Ÿè¾¾A100èŠ¯ç‰‡ï¼Œæœ‰æ‰‹æ’¸çš„HAI-LLMè®­ç»ƒæ¡†æž¶[HAI-LLMï¼šé«˜æ•ˆä¸”è½»é‡çš„å¤§æ¨¡åž‹è®­ç»ƒå·¥å…·](https://www.high-flyer.cn/blog/hai-llm/)ã€‚

## 1. æ‘˜è¦

å¼€æºå¤§è¯­è¨€æ¨¡åž‹ï¼ˆLLMsï¼‰çš„å¿«é€Ÿå‘å±•ç€å®žä»¤äººçž©ç›®ã€‚ç„¶è€Œï¼Œä»¥å¾€æ–‡çŒ®ä¸­æè¿°çš„ **scaling law** å­˜åœ¨ä¸åŒç»“è®ºï¼Œè¿™ç»™å¤§è¯­è¨€æ¨¡åž‹çš„æ‰©å±•è’™ä¸Šäº†ä¸€å±‚é˜´å½±ã€‚

æˆ‘ä»¬æ·±å…¥ç ”ç©¶ **scaling law** å¹¶å‘ˆçŽ°ç‹¬ç‰¹å‘çŽ°ï¼Œè¿™äº›å‘çŽ°æœ‰åŠ©äºŽåœ¨ä¸¤ç§å¸¸ç”¨çš„å¼€æºé…ç½®ï¼ˆ7B å’Œ 67B å‚æ•°ï¼‰ä¸‹è¿›è¡Œå¤§è§„æ¨¡æ¨¡åž‹çš„æ‰©å±•ã€‚åœ¨ **scaling law** çš„æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä»¬æŽ¨å‡º DeepSeek LLM é¡¹ç›®ï¼Œè‡´åŠ›äºŽä»Žé•¿è¿œè§’åº¦æŽ¨è¿›å¼€æºè¯­è¨€æ¨¡åž‹çš„å‘å±•ã€‚

ä¸ºæ”¯æŒé¢„è®­ç»ƒé˜¶æ®µï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªç›®å‰åŒ…å« 2 ä¸‡äº¿ tokes çš„æ•°æ®é›†ï¼Œä¸”è¯¥æ•°æ®é›†è¿˜åœ¨æŒç»­æ‰©å±•ã€‚æˆ‘ä»¬è¿›ä¸€æ­¥å¯¹ DeepSeek LLM åŸºç¡€æ¨¡åž‹è¿›è¡Œç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰å’Œç›´æŽ¥åå¥½ä¼˜åŒ–ï¼ˆDPOï¼‰ï¼Œä»Žè€Œåˆ›å»ºäº† DeepSeek Chat æ¨¡åž‹ã€‚

è¯„ä¼°ç»“æžœè¡¨æ˜Žï¼ŒDeepSeek LLM 67B å‚æ•°æ¨¡åž‹åœ¨ä¸€ç³»åˆ—åŸºå‡†æµ‹è¯•ä¸­ä¼˜äºŽ LLaMAâ€“2 70B å‚æ•°æ¨¡åž‹ï¼Œå°¤å…¶æ˜¯åœ¨ä»£ç ã€æ•°å­¦å’ŒæŽ¨ç†é¢†åŸŸã€‚æ­¤å¤–ï¼Œå¼€æ”¾å¼è¯„ä¼°æ˜¾ç¤ºï¼Œæˆ‘ä»¬çš„ DeepSeek LLM 67B å‚æ•° Chat æ¨¡åž‹çš„æ€§èƒ½ä¼˜äºŽ GPT â€“ 3.5ã€‚


## 2. ä»‹ç»

è¿™ä¸€æ³¢å‘å±•ç”±é—­æºäº§å“å¼•å‘ï¼Œæ¯”å¦‚ ChatGPTï¼ˆOpenAIï¼Œ2022 å¹´ï¼‰ã€Claudeï¼ˆAnthropicï¼Œ2023 å¹´ï¼‰å’Œ Bardï¼ˆè°·æ­Œï¼Œ2023 å¹´ï¼‰ï¼Œè¿™äº›äº§å“çš„å¼€å‘éœ€è¦å¤§é‡è®¡ç®—èµ„æºå’Œé«˜æ˜‚çš„æ ‡æ³¨æˆæœ¬ã€‚è¿™äº›äº§å“æžå¤§åœ°æé«˜äº†ç¤¾åŒºå¯¹å¼€æºå¤§è¯­è¨€æ¨¡åž‹èƒ½åŠ›çš„æœŸæœ›ï¼Œä»Žè€Œæ¿€å‘äº†ä¸€ç³»åˆ—ç ”ç©¶å·¥ä½œï¼ˆBai ç­‰äººï¼Œ2023 å¹´ï¼›Du ç­‰äººï¼Œ2022 å¹´ï¼›Jiang ç­‰äººï¼Œ2023 å¹´ï¼›Touvron ç­‰äººï¼Œ2023aï¼Œbï¼›Yang ç­‰äººï¼Œ2023 å¹´ï¼‰ã€‚åœ¨è¿™äº›å·¥ä½œä¸­ï¼ŒLLaMA ç³»åˆ—æ¨¡åž‹ï¼ˆTouvron ç­‰äººï¼Œ2023aï¼Œbï¼‰è„±é¢–è€Œå‡ºã€‚å®ƒæ•´åˆäº†ä¸€ç³»åˆ—æˆæžœï¼Œåˆ›å»ºäº†é«˜æ•ˆç¨³å®šçš„æž¶æž„ï¼Œæž„å»ºäº†å‚æ•°è§„æ¨¡ä»Ž 7B åˆ° 70B ä¸ç­‰çš„é«˜æ€§èƒ½æ¨¡åž‹ã€‚å› æ­¤ï¼Œ**LLaMA ç³»åˆ—å·²æˆä¸ºå¼€æºæ¨¡åž‹ä¸­æž¶æž„å’Œæ€§èƒ½æ–¹é¢äº‹å®žä¸Šçš„åŸºå‡†**ã€‚

åœ¨ LLaMA ä¹‹åŽï¼Œå¼€æºç¤¾åŒºä¸»è¦ä¸“æ³¨äºŽè®­ç»ƒå›ºå®šè§„æ¨¡ï¼ˆ70 äº¿ã€130 äº¿ã€340 äº¿å’Œ 700 äº¿å‚æ•°ï¼‰çš„é«˜è´¨é‡æ¨¡åž‹ï¼Œå´å¸¸å¸¸å¿½è§†å¯¹å¤§è¯­è¨€æ¨¡åž‹ scaling law çš„ç ”ç©¶æŽ¢ç´¢ï¼ˆHoffmann ç­‰äººï¼Œ2022ï¼›Kaplan ç­‰äººï¼Œ2020ï¼‰ã€‚å°½ç®¡å¦‚æ­¤ï¼Œé‰´äºŽå½“å‰çš„å¼€æºæ¨¡åž‹ä»…ä»…å¤„äºŽé€šç”¨äººå·¥æ™ºèƒ½ï¼ˆAGIï¼‰å‘å±•çš„åˆå§‹é˜¶æ®µï¼Œå¯¹ç¼©æ”¾å®šå¾‹çš„ç ”ç©¶è‡³å…³é‡è¦ã€‚æ­¤å¤–ï¼Œæ—©æœŸçš„ç ”ç©¶ï¼ˆHoffmann ç­‰äººï¼Œ2022ï¼›Kaplan ç­‰äººï¼Œ2020ï¼‰åœ¨æ¨¡åž‹å’Œæ•°æ®éšç€è®¡ç®—èµ„æºå¢žåŠ çš„ç¼©æ”¾é—®é¢˜ä¸Šå¾—å‡ºäº†ä¸åŒç»“è®ºï¼Œè€Œä¸”å¯¹è¶…å‚æ•°çš„è®¨è®ºä¹Ÿä¸å¤Ÿå……åˆ†ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å¹¿æ³›ç ”ç©¶äº†è¯­è¨€æ¨¡åž‹çš„ç¼©æ”¾è¡Œä¸ºï¼Œå¹¶å°†ç ”ç©¶ç»“æžœåº”ç”¨äºŽä¸¤ç§å¹¿æ³›ä½¿ç”¨çš„å¤§è§„æ¨¡æ¨¡åž‹é…ç½®ï¼Œå³ 7B å’Œ 67B å‚æ•°çš„æ¨¡åž‹ã€‚æˆ‘ä»¬çš„ç ”ç©¶æ—¨åœ¨ä¸ºæœªæ¥å¼€æºå¤§è¯­è¨€æ¨¡åž‹çš„æ‰©å±•å¥ å®šåŸºç¡€ï¼Œä¸ºè¯¥é¢†åŸŸçš„è¿›ä¸€æ­¥å‘å±•é“ºå¹³é“è·¯ã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬é¦–å…ˆç ”ç©¶äº†æ‰¹é‡å¤§å°å’Œå­¦ä¹ çŽ‡çš„ scaling lawï¼Œå‘çŽ°äº†å®ƒä»¬éšæ¨¡åž‹è§„æ¨¡å˜åŒ–çš„è¶‹åŠ¿ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯¹æ•°æ®å’Œæ¨¡åž‹è§„æ¨¡çš„ scaling law è¿›è¡Œäº†å…¨é¢ç ”ç©¶ï¼ŒæˆåŠŸæ­ç¤ºäº†æœ€ä¼˜çš„æ¨¡åž‹/æ•°æ®æ‰©å±•åˆ†é…ç­–ç•¥ï¼Œå¹¶é¢„æµ‹äº†å¤§è§„æ¨¡æ¨¡åž‹çš„é¢„æœŸæ€§èƒ½ã€‚æ­¤å¤–ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬å‘çŽ°ï¼Œä¸åŒæ•°æ®é›†å¾—å‡ºçš„ scaling law å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚**è¿™è¡¨æ˜Žæ•°æ®é›†çš„é€‰æ‹©å¯¹ scaling law è¡Œä¸ºæœ‰æ˜¾è‘—å½±å“ï¼Œæ„å‘³ç€åœ¨è·¨æ•°æ®é›†æŽ¨å¹¿ç¼©æ”¾å®šå¾‹æ—¶åº”è°¨æ…Žè¡Œäº‹**ã€‚

åœ¨æˆ‘ä»¬çš„ scaling law æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä»¬ä»Žå¤´å¼€å§‹æž„å»ºå¼€æºå¤§è¯­è¨€æ¨¡åž‹ï¼Œå¹¶å°½å¯èƒ½å¤šåœ°å‘å¸ƒä¿¡æ¯ä¾›ç¤¾åŒºå‚è€ƒã€‚æˆ‘ä»¬æ”¶é›†äº† 2 ä¸‡äº¿ä¸ª tokens ç”¨äºŽé¢„è®­ç»ƒï¼Œä¸»è¦æ˜¯ä¸­æ–‡å’Œè‹±æ–‡æ•°æ®ã€‚**åœ¨æ¨¡åž‹å±‚é¢ï¼Œæˆ‘ä»¬æ€»ä½“ä¸Šéµå¾ª LLaMA çš„æž¶æž„ï¼Œä½†å°†ä½™å¼¦é€€ç«å­¦ä¹ çŽ‡çš„è°ƒåº¦å™¨æ›¿æ¢ä¸ºå¤šæ­¥å­¦ä¹ çŽ‡è°ƒåº¦å™¨ï¼Œè¿™æ ·åœ¨ä¿æŒæ¨¡åž‹æ€§èƒ½çš„åŒæ—¶ï¼Œæ›´ä¾¿äºŽæŒç»­è®­ç»ƒ**ã€‚æˆ‘ä»¬ä»Žå¤šç§æ¥æºæ”¶é›†äº†è¶…è¿‡ 100ä¸‡ä¸ªå®žä¾‹ï¼Œç”¨äºŽç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰ï¼ˆæ¬§é˜³ç­‰äººï¼Œ2022ï¼‰ã€‚æœ¬æ–‡å°†åˆ†äº«æˆ‘ä»¬åœ¨ä¸åŒç›‘ç£å¾®è°ƒç­–ç•¥æ–¹é¢çš„ç»éªŒï¼Œä»¥åŠåœ¨æ•°æ®æ¶ˆèžæŠ€æœ¯ä¸Šçš„å‘çŽ°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åˆ©ç”¨ç›´æŽ¥åå¥½ä¼˜åŒ–ï¼ˆDPOï¼‰ï¼ˆæ‹‰æ³•ä¼Šæ´›å¤«ç­‰äººï¼Œ2023ï¼‰æ¥æå‡æ¨¡åž‹çš„å¯¹è¯æ€§èƒ½ã€‚

æˆ‘ä»¬ä½¿ç”¨åŸºç¡€æ¨¡åž‹å’ŒèŠå¤©æ¨¡åž‹è¿›è¡Œäº†å¹¿æ³›è¯„ä¼°ã€‚è¯„ä¼°ç»“æžœè¡¨æ˜Žï¼Œ**DeepSeek LLM åœ¨å„ç§åŸºå‡†æµ‹è¯•ä¸­å‡ä¼˜äºŽ LLaMA-2 70Bï¼Œå°¤å…¶æ˜¯åœ¨ä»£ç ã€æ•°å­¦å’ŒæŽ¨ç†é¢†åŸŸ**ã€‚ç»è¿‡ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰å’Œç›´æŽ¥åå¥½ä¼˜åŒ–ï¼ˆDPOï¼‰åŽï¼ŒDeepSeek 67B èŠå¤©æ¨¡åž‹åœ¨ä¸­æ–‡å’Œè‹±æ–‡å¼€æ”¾å¼è¯„ä¼°ä¸­å‡ä¼˜äºŽ GPT-3.5ã€‚è¿™å‡¸æ˜¾äº† DeepSeek 67B åœ¨ç”Ÿæˆé«˜è´¨é‡å›žå¤ä»¥åŠç”¨ä¸¤ç§è¯­è¨€è¿›è¡Œæœ‰æ„ä¹‰å¯¹è¯æ–¹é¢çš„å“è¶Šæ€§èƒ½ã€‚æ­¤å¤–ï¼Œå®‰å…¨è¯„ä¼°è¡¨æ˜Žï¼ŒDeepSeek 67B Chat åœ¨å®žé™…åº”ç”¨ä¸­èƒ½å¤Ÿç»™å‡ºæ— å®³çš„å›žå¤ã€‚

## 3. é¢„è®­ç»ƒ

### æ•°æ®é›†

æˆ‘ä»¬çš„**ä¸»è¦ç›®æ ‡æ˜¯å…¨é¢æå‡æ•°æ®é›†çš„ä¸°å¯Œæ€§å’Œå¤šæ ·æ€§**ã€‚æˆ‘ä»¬ä»Žä¸€äº›å¯é çš„èµ„æ–™æ¥æºï¼ˆå¦‚ Computer, 2023; Gao ç­‰äººï¼Œ2020; Penedo ç­‰äººï¼Œ2023; Touvron ç­‰äººï¼Œ2023aï¼‰ä¸­èŽ·å¾—äº†å®è´µçš„è§è§£ã€‚**ä¸ºå®žçŽ°è¿™äº›ç›®æ ‡ï¼Œæˆ‘ä»¬å°†æ–¹æ³•åˆ†ä¸ºä¸‰ä¸ªå…³é”®é˜¶æ®µï¼šåŽ»é‡ã€ç­›é€‰å’Œé‡æ–°æ··åˆ**ã€‚åŽ»é‡å’Œé‡æ–°æ··åˆé˜¶æ®µé€šè¿‡å¯¹ç‹¬ç‰¹å®žä¾‹è¿›è¡Œé‡‡æ ·ï¼Œç¡®ä¿æ•°æ®å…·æœ‰å¤šæ ·åŒ–çš„ä»£è¡¨æ€§ã€‚ç­›é€‰é˜¶æ®µåˆ™æé«˜äº†ä¿¡æ¯å¯†åº¦ï¼Œä»Žè€Œä½¿æ¨¡åž‹è®­ç»ƒæ›´åŠ é«˜æ•ˆã€‚

**æˆ‘ä»¬é‡‡ç”¨äº†æ¿€è¿›çš„åŽ»é‡ç­–ç•¥ï¼Œæ‰©å¤§äº†åŽ»é‡èŒƒå›´**ã€‚æˆ‘ä»¬çš„åˆ†æžæ˜¾ç¤ºï¼Œä¸Žåœ¨å•ä¸ªæ•°æ®è½¬å‚¨ä¸­è¿›è¡ŒåŽ»é‡ç›¸æ¯”ï¼Œå¯¹æ•´ä¸ª Common Crawl è¯­æ–™åº“è¿›è¡ŒåŽ»é‡èƒ½åˆ é™¤æ›´å¤šçš„é‡å¤å®žä¾‹ã€‚è·¨ 91 ä¸ªæ•°æ®è½¬å‚¨è¿›è¡ŒåŽ»é‡æ‰€åˆ é™¤çš„æ–‡æ¡£æ•°é‡æ˜¯å•æ•°æ®è½¬å‚¨åŽ»é‡æ–¹æ³•çš„å››å€ã€‚

å¯¹äºŽæˆ‘ä»¬çš„åˆ†è¯å™¨ï¼Œæˆ‘ä»¬åŸºäºŽ Huggingface å›¢é˜Ÿï¼ˆ2019 å¹´ï¼‰å¼€å‘çš„ tokenizers åº“ï¼Œå®žçŽ°äº†å­—èŠ‚çº§å­—èŠ‚å¯¹ç¼–ç ï¼ˆBBPEï¼‰ç®—æ³•ã€‚æˆ‘ä»¬é‡‡ç”¨äº†é¢„åˆ†è¯æŠ€æœ¯æ¥é˜²æ­¢ä¸åŒå­—ç¬¦ç±»åˆ«çš„æ ‡è®°åˆå¹¶ï¼Œä¾‹å¦‚æ¢è¡Œç¬¦ã€æ ‡ç‚¹ç¬¦å·ä»¥åŠä¸­æ—¥éŸ©ï¼ˆCJKï¼‰ç¬¦å·ï¼Œè¿™ä¸Ž GPT-2ï¼ˆRadford ç­‰äººï¼Œ2019 å¹´ï¼‰çš„åšæ³•ç±»ä¼¼ã€‚æˆ‘ä»¬è¿˜å‚ç…§ï¼ˆTouvron ç­‰äººï¼Œ2023aï¼Œbï¼‰çš„æ–¹æ³•ï¼Œé€‰æ‹©å°†æ•°å­—æ‹†åˆ†ä¸ºå•ä¸ªæ•°å­—ã€‚æ ¹æ®æˆ‘ä»¬ä¹‹å‰çš„ç»éªŒï¼Œæˆ‘ä»¬å°†è¯æ±‡è¡¨ä¸­çš„å¸¸è§„æ ‡è®°æ•°é‡è®¾ç½®ä¸º 100000ã€‚åˆ†è¯å™¨åœ¨å¤§çº¦ 24GB çš„å¤šè¯­è¨€è¯­æ–™åº“ä¸Šè¿›è¡Œè®­ç»ƒï¼Œå¹¶ä¸”æˆ‘ä»¬åœ¨æœ€ç»ˆçš„è¯æ±‡è¡¨ä¸­å¢žåŠ äº† 15 ä¸ªç‰¹æ®Šæ ‡è®°ï¼Œä½¿æ€»å¤§å°è¾¾åˆ° 100015ã€‚ä¸ºç¡®ä¿è®­ç»ƒæœŸé—´çš„è®¡ç®—æ•ˆçŽ‡ï¼Œå¹¶ä¸ºæœªæ¥å¯èƒ½éœ€è¦çš„ä»»ä½•é¢å¤–ç‰¹æ®Šæ ‡è®°é¢„ç•™ç©ºé—´ï¼Œæˆ‘ä»¬å°†è®­ç»ƒæ—¶æ¨¡åž‹çš„è¯æ±‡è¡¨å¤§å°é…ç½®ä¸º 102400ã€‚

### æ¨¡åž‹ç»“æž„

![deepseek-llm-model-info](./pics/deepseek-llm-model-info.png)

DeepSeek LLM çš„å¾®è§‚è®¾è®¡åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šéµå¾ª LLaMAï¼ˆTouvron ç­‰äººï¼Œ2023aï¼Œbï¼‰çš„è®¾è®¡ï¼Œé‡‡ç”¨å¸¦æœ‰ RMSNormï¼ˆZhang å’Œ Sennrichï¼Œ2019ï¼‰å‡½æ•°çš„ Pre-Norm ç»“æž„ï¼Œå¹¶ä½¿ç”¨ SwiGLUï¼ˆShazeerï¼Œ2020ï¼‰ä½œä¸º FFN å±‚çš„æ´»å‡½æ•°ã€‚å®ƒè¿˜é‡‡ç”¨æ—‹è½¬åµŒå…¥ RoPEï¼ˆSu ç­‰äººï¼Œ2024ï¼‰è¿›è¡Œä½ç½®ç¼–ç ã€‚ä¸ºäº†ä¼˜åŒ–æŽ¨ç†æˆæœ¬ï¼Œ670 äº¿å‚æ•°çš„æ¨¡åž‹ä½¿ç”¨åˆ†ç»„æŸ¥è¯¢æ³¨æ„åŠ›æœºåˆ¶ï¼ˆGQAï¼‰ï¼ˆAinslie ç­‰äººï¼Œ2023ï¼‰ï¼Œè€Œéžä¼ ç»Ÿçš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼ˆMHAï¼‰ã€‚

![deepseek-llm-transformer](./pics/deepseek-llm-transformer.jpg)

![deepseek-llm-mh](./pics/deepseek-llm-mh.jpg)

ç„¶è€Œï¼Œåœ¨å®è§‚è®¾è®¡æ–¹é¢ï¼ŒDeepSeek LLM ç•¥æœ‰ä¸åŒã€‚å…·ä½“æ¥è¯´ï¼ŒDeepSeek LLM 7B æ˜¯ä¸€ä¸ª 30 å±‚çš„ç½‘ç»œï¼Œè€Œ DeepSeek LLM 67B æœ‰ 95 å±‚ã€‚è¿™äº›å±‚æ•°çš„è°ƒæ•´ï¼Œåœ¨ä¿æŒä¸Žå…¶ä»–å¼€æºæ¨¡åž‹å‚æ•°ä¸€è‡´æ€§çš„åŒæ—¶ï¼Œä¹Ÿæœ‰åˆ©äºŽæ¨¡åž‹æµæ°´çº¿åˆ†åŒºï¼Œä»Žè€Œä¼˜åŒ–è®­ç»ƒå’ŒæŽ¨ç†è¿‡ç¨‹ã€‚

### è¶…å‚æ•°ï¼ˆhyperparametersï¼‰

![deepseek-llm-hyperparameters](./pics/deepseek-llm-hyperparameters.png)

**é¢„è®­ç»ƒæœŸé—´é‡‡ç”¨å¤šæ­¥å­¦ä¹ çŽ‡è°ƒåº¦å™¨**ï¼Œè€Œéžå…¸åž‹çš„ä½™å¼¦é€€ç«è°ƒåº¦å™¨ã€‚å…·ä½“è€Œè¨€ï¼Œæ¨¡åž‹çš„å­¦ä¹ çŽ‡åœ¨ç»è¿‡ 2000 ä¸ªé¢„çƒ­æ­¥éª¤åŽè¾¾åˆ°æœ€å¤§å€¼ï¼ŒéšåŽåœ¨å¤„ç†å®Œ 80% çš„è®­ç»ƒè¯å…ƒåŽé™è‡³æœ€å¤§å€¼çš„ 31.6% ã€‚åœ¨å¤„ç†å®Œ 90% çš„è¯å…ƒåŽï¼Œå­¦ä¹ çŽ‡è¿›ä¸€æ­¥é™è‡³æœ€å¤§å€¼çš„ 10%ã€‚è®­ç»ƒé˜¶æ®µçš„æ¢¯åº¦è£å‰ªè®¾ç½®ä¸º 1.0 ã€‚

åŸºäºŽæˆ‘ä»¬çš„å®žè¯ç ”ç©¶ç»“æžœï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå°½ç®¡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸åŒé˜¶æ®µæŸå¤±å‡å°‘è¶‹åŠ¿æœ‰æ‰€ä¸åŒï¼Œä½†**ä½¿ç”¨å¤šæ­¥å­¦ä¹ çŽ‡è°ƒåº¦å™¨å¾—åˆ°çš„æœ€ç»ˆæ€§èƒ½ä¸Žä½™å¼¦è°ƒåº¦å™¨åŸºæœ¬ä¸€è‡´**ï¼Œå¦‚å›¾ï¼ˆaï¼‰æ‰€ç¤ºã€‚åœ¨ä¿æŒæ¨¡åž‹è§„æ¨¡ä¸å˜çš„æƒ…å†µä¸‹è°ƒæ•´è®­ç»ƒè§„æ¨¡æ—¶ï¼Œå¤šæ­¥å­¦ä¹ çŽ‡è°ƒåº¦å™¨å…è®¸é‡å¤åˆ©ç”¨ç¬¬ä¸€é˜¶æ®µçš„è®­ç»ƒæˆæžœï¼Œä¸ºæŒç»­è®­ç»ƒæä¾›äº†ç‹¬ç‰¹çš„ä¾¿åˆ©ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©å¤šæ­¥å­¦ä¹ çŽ‡è°ƒåº¦å™¨ä½œä¸ºé»˜è®¤è®¾ç½®ã€‚æˆ‘ä»¬è¿˜åœ¨å›¾ï¼ˆbï¼‰ä¸­å±•ç¤ºäº†ï¼Œ**è°ƒæ•´å¤šæ­¥å­¦ä¹ çŽ‡è°ƒåº¦å™¨ä¸­ä¸åŒé˜¶æ®µçš„æ¯”ä¾‹ï¼Œå¯ä½¿æ€§èƒ½ç•¥æœ‰æå‡**ã€‚ç„¶è€Œï¼Œä¸ºäº†å¹³è¡¡æŒç»­è®­ç»ƒä¸­çš„å¤ç”¨çŽ‡å’Œæ¨¡åž‹æ€§èƒ½ï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä¸Šè¿°ä¸‰ä¸ªé˜¶æ®µåˆ†åˆ«ä¸º 80%ã€10% å’Œ 10% çš„æ¯”ä¾‹åˆ†é…ã€‚

![deepseek-llm-multi-step-lrs](./pics/deepseek-llm-multi-step-lrs.png)

### åŸºç¡€è®¾æ–½

æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåä¸º HAI-LLMï¼ˆHigh â€“ flyerï¼Œ2023ï¼‰çš„é«˜æ•ˆè½»é‡çº§è®­ç»ƒæ¡†æž¶æ¥è®­ç»ƒå’Œè¯„ä¼°å¤§è¯­è¨€æ¨¡åž‹ã€‚ä¸Ž Megatronï¼ˆKorthikanti ç­‰äººï¼Œ2023ï¼›Narayanan ç­‰äººï¼Œ2021ï¼›Shoeybi ç­‰äººï¼Œ2019ï¼‰ä¸€æ ·ï¼Œæ•°æ®å¹¶è¡Œã€å¼ é‡å¹¶è¡Œã€åºåˆ—å¹¶è¡Œå’Œ 1F1B æµæ°´çº¿å¹¶è¡Œéƒ½é›†æˆåˆ°äº†è¿™ä¸ªæ¡†æž¶ä¸­ã€‚æˆ‘ä»¬è¿˜åˆ©ç”¨äº† FlashAttentionï¼ˆDaoï¼Œ2023ï¼›Dao ç­‰äººï¼Œ2022ï¼‰æŠ€æœ¯æ¥æé«˜ç¡¬ä»¶åˆ©ç”¨çŽ‡ã€‚é‡‡ç”¨ ZeRO-1ï¼ˆRajbhandari ç­‰äººï¼Œ2020ï¼‰åœ¨æ•°æ®å¹¶è¡Œç­‰çº§ä¸Šå¯¹ä¼˜åŒ–å™¨çŠ¶æ€è¿›è¡Œåˆ†åŒºã€‚æˆ‘ä»¬è¿˜åŠªåŠ›è®©è®¡ç®—å’Œé€šä¿¡é‡å ï¼Œä»¥å°½é‡å‡å°‘é¢å¤–çš„ç­‰å¾…å¼€é”€ï¼ŒåŒ…æ‹¬æœ€åŽä¸€ä¸ªå¾®æ‰¹æ¬¡çš„åå‘ä¼ æ’­è¿‡ç¨‹ä»¥åŠ ZeRO-1 ä¸­çš„è§„çº¦-æ•£å°„æ“ä½œï¼Œè¿˜æœ‰åºåˆ—å¹¶è¡Œä¸­çš„é€šç”¨çŸ©é˜µä¹˜æ³•ï¼ˆGEMMï¼‰è®¡ç®—ä¸Žå…¨æ”¶é›†/è§„çº¦-æ•£å°„æ“ä½œã€‚ä¸ºåŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼Œå¯¹ä¸€äº›å±‚ / æ“ä½œç¬¦è¿›è¡Œäº†èžåˆï¼ŒåŒ…æ‹¬å°½å¯èƒ½å¯¹å±‚å½’ä¸€åŒ–ï¼ˆLayerNormï¼‰ã€é€šç”¨çŸ©é˜µä¹˜æ³•ï¼ˆGEMMï¼‰ä»¥åŠ Adam æ›´æ–°æ“ä½œã€‚ä¸ºæé«˜æ¨¡åž‹è®­ç»ƒçš„ç¨³å®šæ€§ï¼Œæˆ‘ä»¬ä»¥ bf16 ç²¾åº¦è®­ç»ƒæ¨¡åž‹ï¼Œä½†ä»¥ fp32 ç²¾åº¦ç´¯ç§¯æ¢¯åº¦ã€‚é€šè¿‡æ‰§è¡ŒåŽŸåœ°äº¤å‰ç†µè®¡ç®—æ¥å‡å°‘ GPU å†…å­˜æ¶ˆè€—ï¼Œå³ï¼šæˆ‘ä»¬åœ¨äº¤å‰ç†µ CUDA å†…æ ¸ä¸­å³æ—¶å°† bf16 æ ¼å¼çš„å¯¹æ•°å‡ çŽ‡ï¼ˆlogitsï¼‰è½¬æ¢ä¸º fp32 ç²¾åº¦ï¼ˆè€Œä¸æ˜¯äº‹å…ˆåœ¨é«˜å¸¦å®½å†…å­˜ï¼ˆHBMï¼‰ä¸­è¿›è¡Œè½¬æ¢ï¼‰ï¼Œè®¡ç®—ç›¸åº”çš„ bf16 æ¢¯åº¦ï¼Œå¹¶ç”¨æ¢¯åº¦è¦†ç›–å¯¹æ•°å‡ çŽ‡ã€‚

æ¨¡åž‹æƒé‡å’Œä¼˜åŒ–å™¨çŠ¶æ€æ¯ 5 åˆ†é’Ÿå¼‚æ­¥ä¿å­˜ä¸€æ¬¡ï¼Œè¿™æ„å‘³ç€åœ¨å¶å°”å‡ºçŽ°ç¡¬ä»¶æˆ–ç½‘ç»œæ•…éšœçš„æœ€åæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æŸå¤±çš„è®­ç»ƒè¿›åº¦ä¸ä¼šè¶…è¿‡ 5 åˆ†é’Ÿã€‚è¿™äº›ä¸´æ—¶çš„æ¨¡åž‹æ£€æŸ¥ç‚¹ä¼šå®šæœŸæ¸…ç†ï¼Œä»¥é¿å…å ç”¨è¿‡å¤šå­˜å‚¨ç©ºé—´ã€‚æˆ‘ä»¬è¿˜æ”¯æŒä»Žä¸åŒçš„ä¸‰ç»´å¹¶è¡Œé…ç½®æ¢å¤è®­ç»ƒï¼Œä»¥åº”å¯¹è®¡ç®—é›†ç¾¤è´Ÿè½½çš„åŠ¨æ€å˜åŒ–ã€‚

### ç¼©æ”¾å®šå¾‹(Scaling Laws)

å…³äºŽç¼©æ”¾å®šå¾‹çš„ç ”ç©¶ï¼ˆèµ«æ–¯å†…æ–¯ç­‰äººï¼Œ2017 å¹´ï¼‰æ—©äºŽå¤§è¯­è¨€æ¨¡åž‹çš„å‡ºçŽ°ã€‚ç¼©æ”¾å®šå¾‹ï¼ˆäº¨å°¼æ ¹ç­‰äººï¼Œ2020 å¹´ï¼›éœå¤«æ›¼ç­‰äººï¼Œ2022 å¹´ï¼›å¡æ™®å…°ç­‰äººï¼Œ2020 å¹´ï¼‰è¡¨æ˜Žï¼Œéšç€è®¡ç®—èµ„æºé¢„ç®— Cã€æ¨¡åž‹è§„æ¨¡ N å’Œ æ•°æ®è§„æ¨¡ D çš„å¢žåŠ ï¼Œæ¨¡åž‹æ€§èƒ½æœ‰æœ›å¾—åˆ°å¯é¢„æµ‹çš„æå‡ã€‚**å½“æ¨¡åž‹è§„æ¨¡ N ç”¨æ¨¡åž‹å‚æ•°è¡¨ç¤ºï¼Œæ•°æ®è§„æ¨¡ D ç”¨ tokens æ•°é‡è¡¨ç¤ºæ—¶ï¼ŒC å¯è¿‘ä¼¼è¡¨ç¤ºä¸º C = 6NDã€‚å› æ­¤ï¼Œåœ¨å¢žåŠ è®¡ç®—èµ„æºé¢„ç®—æ—¶ï¼Œå¦‚ä½•ä¼˜åŒ–æ¨¡åž‹ä¸Žæ•°æ®è§„æ¨¡ä¹‹é—´çš„åˆ†é…ï¼Œä¹Ÿæ˜¯ç¼©æ”¾å®šå¾‹ç ”ç©¶ä¸­çš„ä¸€ä¸ªå…³é”®ç›®æ ‡**ã€‚

æŽ¥ç€ï¼Œæˆ‘ä»¬ç ”ç©¶æ¨¡åž‹è§„æ¨¡å’Œæ•°æ®è§„æ¨¡çš„ç¼©æ”¾å®šå¾‹ã€‚ä¸ºé™ä½Žå®žéªŒæˆæœ¬ä¸Žæ‹Ÿåˆéš¾åº¦ï¼Œæˆ‘ä»¬é‡‡ç”¨äº† Chinchilla è®ºæ–‡ï¼ˆéœå¤«æ›¼ç­‰äººï¼Œ2022 å¹´ï¼‰ä¸­çš„ç­‰æµ®ç‚¹è¿ç®—æ¬¡æ•°ï¼ˆIsoFLOPï¼‰æ›²çº¿æ³•æ¥æ‹Ÿåˆç¼©æ”¾æ›²çº¿ã€‚**ä¸ºæ›´å‡†ç¡®åœ°è¡¨ç¤ºæ¨¡åž‹è§„æ¨¡ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ç§æ–°çš„æ¨¡åž‹è§„æ¨¡è¡¨ç¤ºæ–¹å¼ â€”â€” æ¯ä¸ª token çš„éžåµŒå…¥æµ®ç‚¹è¿ç®—æ¬¡æ•°ï¼ˆnon-embedding FLOPs/tokenï¼‰ Mï¼Œä»¥å–ä»£ä¹‹å‰ä½¿ç”¨çš„æ¨¡åž‹å‚æ•° Nï¼Œå¹¶å¯¹è¿‘ä¼¼è®¡ç®—é¢„ç®—å…¬å¼ C = 6ND è¿›è¡Œäº†æ›¿æ¢ï¼Œå°†å…¶æ›¿æ¢ä¸ºæ›´ç²¾ç¡®çš„å…¬å¼ C = MDã€‚å®žéªŒç»“æžœä¸ºæœ€ä¼˜çš„æ¨¡åž‹/æ•°æ®æ‰©å®¹åˆ†é…ç­–ç•¥åŠæ€§èƒ½é¢„æµ‹æä¾›äº†æ·±åˆ»è§è§£ï¼Œè¿˜å‡†ç¡®é¢„æµ‹äº† DeepSeek LLM 7B å‚æ•°å’Œ 67B å‚æ•°æ¨¡åž‹çš„é¢„æœŸæ€§èƒ½ã€‚**
> The experimental results provided insights into the optimal
model/data scaling-up allocation strategy and performance predictions, and also accurately
forecasted the expected performance of DeepSeek LLM 7B and 67B models.

æ­¤å¤–ï¼Œåœ¨æŽ¢ç´¢ç¼©æ”¾å®šå¾‹çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„æ•°æ®åŽ†ç»å¤šæ¬¡è¿­ä»£ï¼Œè´¨é‡ä¸æ–­æå‡ã€‚æˆ‘ä»¬å°è¯•åœ¨å„ç§æ•°æ®é›†ä¸Šæ‹Ÿåˆç¼©æ”¾æ›²çº¿ï¼Œå‘çŽ°æ•°æ®è´¨é‡å¯¹æœ€ä¼˜çš„æ¨¡åž‹/æ•°æ®æ‰©å®¹åˆ†é…ç­–ç•¥æœ‰æ˜¾è‘—å½±å“ã€‚**æ•°æ®è´¨é‡è¶Šé«˜ï¼Œå¢žåŠ çš„è®¡ç®—é¢„ç®—å°±è¶Šåº”åˆ†é…ç»™æ¨¡åž‹æ‰©å®¹**ã€‚è¿™æ„å‘³ç€åœ¨ç›¸åŒçš„æ•°æ®è§„æ¨¡ä¸‹ï¼Œé«˜è´¨é‡æ•°æ®èƒ½å¤ŸæŽ¨åŠ¨æ›´å¤§è§„æ¨¡æ¨¡åž‹çš„è®­ç»ƒã€‚æœ€ä¼˜æ¨¡åž‹/æ•°æ®æ‰©å®¹åˆ†é…ç­–ç•¥çš„å·®å¼‚ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ç§é—´æŽ¥è¯„ä¼°æ•°æ®è´¨é‡çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†ç»§ç»­å¯†åˆ‡å…³æ³¨æ•°æ®è´¨é‡çš„å˜åŒ–åŠå…¶å¯¹ç¼©æ”¾å®šå¾‹çš„å½±å“ï¼Œå¹¶åœ¨æœªæ¥çš„ç ”ç©¶ä¸­æä¾›æ›´å¤šåˆ†æžã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬åœ¨ç¼©æ”¾å®šå¾‹æ–¹é¢çš„è´¡çŒ®å’Œå‘çŽ°å¯æ€»ç»“å¦‚ä¸‹ï¼š

- æˆ‘ä»¬å»ºç«‹äº†è¶…å‚æ•°çš„ç¼©æ”¾å®šå¾‹ï¼Œä¸ºç¡®å®šæœ€ä¼˜è¶…å‚æ•°æä¾›äº†ä¸€ä¸ªå®žè¯æ¡†æž¶ã€‚
- æˆ‘ä»¬é‡‡ç”¨æ¯ä¸ªè¯å…ƒçš„éžåµŒå…¥æµ®ç‚¹è¿ç®—æ¬¡æ•° M æ¥ä»£æ›¿æ¨¡åž‹å‚æ•° N è¡¨ç¤ºæ¨¡åž‹è§„æ¨¡ï¼Œè¿™å¸¦æ¥äº†æ›´å‡†ç¡®çš„æœ€ä¼˜æ¨¡åž‹/æ•°æ®æ‰©å®¹åˆ†é…ç­–ç•¥ï¼Œå¹¶ä¸”èƒ½æ›´å¥½åœ°é¢„æµ‹å¤§è§„æ¨¡æ¨¡åž‹çš„æ³›åŒ–æŸå¤±ã€‚
- é¢„è®­ç»ƒæ•°æ®çš„è´¨é‡ä¼šå½±å“æœ€ä¼˜çš„æ¨¡åž‹/æ•°æ®æ‰©å®¹åˆ†é…ç­–ç•¥ã€‚**æ•°æ®è´¨é‡è¶Šé«˜ï¼Œå¢žåŠ çš„è®¡ç®—é¢„ç®—å°±è¶Šåº”åˆ†é…ç»™æ¨¡åž‹æ‰©å®¹**ã€‚

#### è¶…å‚æ•°çš„ç¼©æ”¾å®šå¾‹ï¼ˆScaling Laws for Hyperparametersï¼‰

æ­¤å¤–ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œåœ¨å…·æœ‰ç›¸åŒè®¡ç®—é¢„ç®—ä½†ä¸åŒæ¨¡åž‹/æ•°æ®åˆ†é…çš„æ¨¡åž‹ä¸­ï¼Œæœ€ä½³å‚æ•°ç©ºé—´ç•¥æœ‰ä¸åŒã€‚è¿™è¡¨æ˜Žéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥äº†è§£è¶…å‚æ•°çš„é€‰æ‹©å’Œè®­ç»ƒåŠ¨æ€ã€‚æˆ‘ä»¬å°†åœ¨æœªæ¥çš„å·¥ä½œä¸­æŽ¢ç´¢è¿™äº›æ–¹é¢ã€‚
> Furthermore, we observed that in models with the same compute budget but different model/data allocations, the optimal parameter space varies slightly. This suggests that further research is needed to understand the selection of hyperparameters and training dynamics. We will explore these aspects in future works.

#### ä¼°è®¡æœ€ä½³æ¨¡åž‹å’Œæ•°æ®ç¼©æ”¾ï¼ˆEstimating Optimal Model and Data Scalingï¼‰

ç»™å®šè®¡ç®—é¢„ç®— ð¶ = ð‘€ð·ï¼Œæ‰¾åˆ°æœ€å°åŒ–æ¨¡åž‹æ³›åŒ–è¯¯å·®çš„æœ€ä½³æ¨¡åž‹è§„æ¨¡ð‘€optå’Œæ•°æ®è§„æ¨¡ð·optï¼š

![generalization-error](./pics/deepseek-llm-generalization-error.png)

ä¸ºäº†é™ä½Žå®žéªŒæˆæœ¬å’Œæ‹Ÿåˆéš¾åº¦ï¼Œä½¿ç”¨ Chinchilla (Hoffmann ç­‰äººï¼Œ2022) çš„ IsoFLOP é…ç½®æ–‡ä»¶æ–¹æ³•æ¥æ‹Ÿåˆç¼©æ”¾æ›²çº¿ï¼š

![isoflop](./pics/deepseek-llm-isoflop.png)

è®¡ç®—é¢„ç®—èŒƒå›´ä»Ž 1e17 åˆ° 3e20ï¼Œå¹¶é’ˆå¯¹æ¯ä¸ªé¢„ç®—è®¾è®¡äº†å¤§çº¦ 10 ç§ä¸åŒçš„æ¨¡åž‹/æ•°æ®è§„æ¨¡åˆ†é…ã€‚æ³›åŒ–è¯¯å·®åœ¨ç‹¬ç«‹éªŒè¯é›†ä¸Šè®¡ç®—ï¼Œè¯¥éªŒè¯é›†çš„åˆ†å¸ƒä¸Žè®­ç»ƒé›†ç±»ä¼¼ï¼ŒåŒ…å« 1 äº¿ä¸ª tokenã€‚

å›¾ 4 å±•ç¤ºäº† IsoFLOP æ›²çº¿å’Œæ¨¡åž‹/æ•°æ®ç¼©æ”¾æ›²çº¿ï¼Œå®ƒä»¬æ˜¯ä½¿ç”¨æ¯ä¸ªè®¡ç®—é¢„ç®—çš„æœ€ä½³æ¨¡åž‹/æ•°æ®åˆ†é…è¿›è¡Œæ‹Ÿåˆçš„ã€‚æœ€ä½³éžåµŒå…¥ FLOP/token ð‘€opt å’Œæœ€ä½³ tokens æ•°é‡ ð·opt çš„å…·ä½“å…¬å¼å¦‚ä¸‹ï¼š

![Mopt & Dopt](./pics/deepseek-llm-md.png)

æ­¤å¤–ï¼Œæˆ‘ä»¬æ ¹æ®è®¡ç®—é¢„ç®—Cå’Œæœ€ä½³æ³›åŒ–è¯¯å·®æ‹Ÿåˆäº†æŸå¤±ç¼©æ”¾æ›²çº¿ï¼Œå¹¶é¢„æµ‹äº†DeepSeek LLM 7Bå’Œ67Bçš„æ³›åŒ–è¯¯å·®ï¼Œå¦‚å›¾5æ‰€ç¤ºã€‚ç»“æžœè¡¨æ˜Žï¼Œä½¿ç”¨å°è§„æ¨¡å®žéªŒå¯ä»¥å‡†ç¡®é¢„æµ‹å…·æœ‰1000å€è®¡ç®—é¢„ç®—çš„æ¨¡åž‹çš„æ€§èƒ½ã€‚è¿™ä¸ºæ›´å¤§è§„æ¨¡çš„æ¨¡åž‹è®­ç»ƒæä¾›äº†ä¿¡å¿ƒå’ŒæŒ‡å¯¼ã€‚

![Performance-scaling-curve](./pics/deepseek-llm-Performance-scaling-curve.png)

#### ä¸åŒæ•°æ®çš„ç¼©æ”¾å®šå¾‹ï¼ˆScaling Laws with Different Dataï¼‰

**éšç€æ•°æ®è´¨é‡çš„æé«˜ï¼Œæ¨¡åž‹ç¼©æ”¾æŒ‡æ•°ð‘Žé€æ¸å¢žåŠ ï¼Œè€Œæ•°æ®ç¼©æ”¾æŒ‡æ•°ð‘åˆ™å‡å°‘ï¼Œè¿™è¡¨æ˜Žå¢žåŠ çš„è®¡ç®—é¢„ç®—åº”è¯¥æ›´å¤šåœ°åˆ†é…ç»™æ¨¡åž‹è€Œä¸æ˜¯æ•°æ®ã€‚**

**å¯¹äºŽè¿™ä¸€å‘çŽ°çš„ä¸€ä¸ªç›´è§‚æŽ¨æµ‹æ˜¯ï¼Œç»è¿‡å……åˆ†çš„è®­ç»ƒåŽï¼Œé«˜è´¨é‡çš„æ•°æ®é€šå¸¸æ„å‘³ç€é€»è¾‘æ¸…æ™°ï¼Œé¢„æµ‹éš¾åº¦è¾ƒä½Žã€‚å› æ­¤ï¼Œåœ¨å¢žåŠ è®¡ç®—é¢„ç®—æ—¶ï¼Œæ‰©å¤§æ¨¡åž‹è§„æ¨¡æ›´ä¸ºæœ‰åˆ©ã€‚**æˆ‘ä»¬å°†ç»§ç»­å¯†åˆ‡å…³æ³¨æ•°æ®è´¨é‡çš„å˜åŒ–åŠå…¶å¯¹ç¼©æ”¾å®šå¾‹çš„å½±å“ï¼Œå¹¶åœ¨æœªæ¥çš„å·¥ä½œä¸­æä¾›æ›´å¤šåˆ†æžã€‚

## 4. å¯¹é½

ä¸ºç¡®ä¿å®žé™…åº”ç”¨çš„æœ‰ç”¨æ€§å’Œå®‰å…¨æ€§ï¼ŒDeepSeek LLMæ”¶é›†äº†å¤§çº¦150ä¸‡æ¡è‹±æ–‡å’Œä¸­æ–‡çš„æŒ‡ä»¤æ•°æ®å®žä¾‹ï¼Œæ¶µç›–äº†å¹¿æ³›çš„æœ‰ç›Šæ€§å’Œæ— å®³æ€§è¯é¢˜ã€‚å…¶ä¸­ï¼Œæœ‰ç›Šæ•°æ®åŒ…å«120ä¸‡ä¸ªå®žä¾‹ï¼Œå…·ä½“åˆ†å¸ƒä¸ºï¼š31.2%ä¸ºä¸€èˆ¬è¯­è¨€ä»»åŠ¡ï¼Œ46.6%ä¸ºæ•°å­¦é—®é¢˜ï¼Œ22.2%ä¸ºç¼–ç¨‹ç»ƒä¹ ã€‚å®‰å…¨æ•°æ®åˆ™ç”±30ä¸‡ä¸ªå®žä¾‹ç»„æˆï¼Œè¦†ç›–äº†å„ç§æ•æ„Ÿè¯é¢˜ã€‚

**DeepSeek LLMå¯¹é½æµç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šç›‘ç£å¾®è°ƒï¼ˆSupervised Fine-Tuning, SFTï¼‰å’Œç›´æŽ¥åå¥½ä¼˜åŒ–ï¼ˆDirect Preference Optimization, DPOï¼‰ã€‚**

ç›‘ç£å¾®è°ƒï¼šå¯¹7Bæ¨¡åž‹è¿›è¡Œäº†4ä¸ªepochçš„å¾®è°ƒï¼Œä½†å¯¹67Bæ¨¡åž‹åªè¿›è¡Œäº†2ä¸ªepochçš„å¾®è°ƒï¼Œå› ä¸ºè§‚å¯Ÿåˆ°67Bæ¨¡åž‹å­˜åœ¨ä¸¥é‡çš„è¿‡æ‹Ÿåˆé—®é¢˜ã€‚GSM8Kå’ŒHumanEvalåœ¨7Bæ¨¡åž‹ä¸Šå¾—åˆ°äº†æŒç»­æ”¹è¿›ï¼Œè€Œ67Bæ¨¡åž‹å¾ˆå¿«è¾¾åˆ°äº†ä¸Šé™ã€‚7Bå’Œ67Bæ¨¡åž‹çš„å­¦ä¹ çŽ‡åˆ†åˆ«ä¸º1e-5å’Œ5e-6ã€‚é™¤äº†ç›‘æŽ§åŸºå‡†å‡†ç¡®åº¦å¤–ï¼Œè¿˜è¯„ä¼°äº†å¾®è°ƒè¿‡ç¨‹ä¸­èŠå¤©æ¨¡åž‹çš„é‡å¤çŽ‡ã€‚æ€»å…±æ”¶é›†äº†3868ä¸ªä¸­æ–‡å’Œè‹±æ–‡æç¤ºï¼Œå¹¶ç¡®å®šäº†ç”Ÿæˆå“åº”ä¸­æ— æ³•ç»ˆæ­¢å¹¶æ— é™é‡å¤æ–‡æœ¬åºåˆ—çš„æ¯”ä¾‹ã€‚è§‚å¯Ÿåˆ°é‡å¤çŽ‡éšç€æ•°å­¦SFTæ•°æ®çš„æ•°é‡å¢žåŠ è€Œä¸Šå‡ã€‚è¿™å¯ä»¥å½’å› äºŽæ•°å­¦SFTæ•°æ®å¶å°”åŒ…å«ç±»ä¼¼çš„æŽ¨ç†æ¨¡å¼ã€‚å› æ­¤ï¼Œè¾ƒå¼±çš„æ¨¡åž‹éš¾ä»¥æŽŒæ¡è¿™ç§æŽ¨ç†æ¨¡å¼ï¼Œå¯¼è‡´é‡å¤æ€§å“åº”ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°è¯•äº†ä¸¤é˜¶æ®µå¾®è°ƒå’ŒDPOï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥ä¿æŒåŸºå‡†åˆ†æ•°å¹¶æ˜¾è‘—å‡å°‘é‡å¤ã€‚

DPOï¼šä¸ºäº†è¿›ä¸€æ­¥æé«˜æ¨¡åž‹çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç›´æŽ¥åå¥½ä¼˜åŒ–ç®—æ³•ï¼Œè¯¥ç®—æ³•è¢«è¯æ˜Žæ˜¯ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„LLMå¯¹é½æ–¹æ³•ã€‚æ ¹æ®æœ‰ç”¨æ€§å’Œæ— å®³æ€§æž„å»ºäº†DPOè®­ç»ƒæ‰€éœ€çš„åå¥½æ•°æ®ã€‚å¯¹äºŽæœ‰ç”¨æ€§æ•°æ®ï¼Œæ”¶é›†äº†å¤šè¯­è¨€æç¤ºï¼Œæ¶µç›–äº†åˆ›æ„å†™ä½œã€é—®ç­”ã€æŒ‡ä»¤è·Ÿéšç­‰ç±»åˆ«ã€‚ç„¶åŽï¼Œä½¿ç”¨DeepSeek Chatæ¨¡åž‹ä½œä¸ºå€™é€‰å“åº”ç”Ÿæˆå“åº”ã€‚ç±»ä¼¼çš„æ“ä½œä¹Ÿåº”ç”¨äºŽæ— å®³æ€§åå¥½æ•°æ®æž„å»ºã€‚

è®­ç»ƒäº†ä¸€ä¸ªDPO epochï¼Œå­¦ä¹ çŽ‡ä¸º5e-6ï¼Œbatch_sizeä¸º512ï¼Œä½¿ç”¨äº†å­¦ä¹ çŽ‡é¢„çƒ­å’Œä½™å¼¦å­¦ä¹ çŽ‡è°ƒåº¦å™¨ã€‚å‘çŽ°DPOå¯ä»¥å¢žå¼ºæ¨¡åž‹çš„å¼€æ”¾å¼ç”ŸæˆæŠ€èƒ½ï¼ŒåŒæ—¶åœ¨æ ‡å‡†åŸºå‡†æµ‹è¯•ä¸­çš„æ€§èƒ½å·®å¼‚å¾ˆå°ã€‚

## 5. è¯„ä¼°ï¼ˆEvaluationï¼‰

### å…¬å¼€æµ‹è¯•é›†

è¯„ä¼°åŸºå‡†åŒ…æ‹¬ï¼š

å¤šå­¦ç§‘å¤šé¡¹é€‰æ‹©æ•°æ®é›†ï¼Œå¦‚MMLUã€C-Evalå’ŒCMMLUã€‚
è¯­è¨€ç†è§£å’ŒæŽ¨ç†æ•°æ®é›†ï¼Œå¦‚HellaSwagã€PIQAã€ARCã€OpenBookQAå’ŒBBHã€‚
é—­å·é—®ç­”æ•°æ®é›†ï¼Œå¦‚TriviaQAå’ŒNaturalQuestionsã€‚
é˜…è¯»ç†è§£æ•°æ®é›†ï¼Œå¦‚RACEã€DROPå’ŒC3ã€‚
å‚è€ƒæ¶ˆæ­§æ•°æ®é›†ï¼Œå¦‚WinoGrandeå’ŒCLUEWSCã€‚
è¯­è¨€å»ºæ¨¡æ•°æ®é›†ï¼Œå¦‚Pileã€‚
ä¸­æ–‡ç†è§£å’Œæ–‡åŒ–æ•°æ®é›†ï¼Œå¦‚CHIDå’ŒCCPMã€‚
æ•°å­¦æ•°æ®é›†ï¼Œå¦‚GSM8Kã€MATHå’ŒCMathã€‚
ä»£ç æ•°æ®é›†ï¼Œå¦‚HumanEvalå’ŒMBPPã€‚
æ ‡å‡†åŒ–è€ƒè¯•æ•°æ®é›†ï¼Œå¦‚AGIEvalã€‚

### base model

å°½ç®¡DeepSeekæ¨¡åž‹æ˜¯åœ¨2TåŒè¯­è¯­æ–™åº“ä¸Šé¢„è®­ç»ƒçš„ï¼Œä½†å®ƒä»¬åœ¨è‹±è¯­è¯­è¨€ç†è§£åŸºå‡†ä¸Šçš„è¡¨çŽ°ä¸ŽLLaMA2æ¨¡åž‹ç›¸å½“ï¼ŒåŽè€…ä¹Ÿæ¶ˆè€—äº†2Tä¸ªtokenï¼Œä½†ä¸“æ³¨äºŽè‹±è¯­ã€‚æ­¤å¤–ï¼Œä¸ŽLLaMA2 70Bç›¸æ¯”ï¼ŒDeepSeek 67Båœ¨MATHã€GSM8Kã€HumanEvalã€MBPPã€BBHå’Œä¸­æ–‡åŸºå‡†ä¸Šçš„è¡¨çŽ°æœ‰äº†æ˜¾è‘—æå‡ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œéšç€æ¨¡åž‹è§„æ¨¡çš„å¢žåŠ ï¼ŒæŸäº›ä»»åŠ¡çš„è¡¨çŽ°ä¹Ÿæœ‰æ‰€æå‡ï¼Œä¾‹å¦‚GSM8Kå’ŒBBHã€‚è€ƒè™‘åˆ°deepseek-llmåœ¨åŒä¸€æ•°æ®é›†ä¸Šè®­ç»ƒäº†7Bå’Œ67Bï¼Œè¿™ç§æ”¹è¿›çš„å‡ºçŽ°å¯ä»¥å½’å› äºŽå¤§åž‹æ¨¡åž‹å¼ºå¤§çš„few-shotå­¦ä¹ èƒ½åŠ›ã€‚éšç€æ•°å­¦æ•°æ®æ¯”ä¾‹çš„å¢žåŠ ï¼Œå°åž‹æ¨¡åž‹å’Œå¤§åž‹æ¨¡åž‹ä¹‹é—´çš„å·®è·å¯èƒ½ä¼šå‡å°ã€‚

DeepSeek 67Bç›¸å¯¹äºŽLLaMA2 70Bçš„ä¼˜åŠ¿å¤§äºŽDeepSeek 7Bç›¸å¯¹äºŽLLaMA2 7Bçš„ä¼˜åŠ¿ã€‚è¿™ä¸€çŽ°è±¡çªæ˜¾äº†è¯­è¨€å†²çªå¯¹è¾ƒå°æ¨¡åž‹çš„å½±å“æ›´å¤§ã€‚æ­¤å¤–ï¼Œå°½ç®¡æ²¡æœ‰ä¸“é—¨é’ˆå¯¹ä¸­æ–‡æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œä½†LLaMA2åœ¨æŸäº›ä¸­æ–‡ä»»åŠ¡ï¼ˆå¦‚CMathï¼‰ä¸Šè¡¨çŽ°å‡ºè‰²ã€‚è¿™è¡¨æ˜Žï¼ŒæŸäº›åŸºæœ¬èƒ½åŠ›ï¼ˆå¦‚æ•°å­¦æŽ¨ç†ï¼‰å¯ä»¥æœ‰æ•ˆåœ°è·¨è¯­è¨€è½¬ç§»ã€‚ç„¶è€Œï¼ŒåƒCHIDè¿™æ ·çš„ä»»åŠ¡éœ€è¦æ¨¡åž‹åœ¨é¢„è®­ç»ƒæœŸé—´æ¶ˆè€—å¤§é‡ä¸­æ–‡æ¥æå‡ä¸­æ–‡æˆè¯­çš„æ•ˆæžœï¼ŒLLaMA2çš„è¡¨çŽ°æ˜Žæ˜¾ä½ŽäºŽDeepSeek LLMã€‚

### chat model

DeepSeek Chatæ¨¡åž‹ï¼Œå¤§å¤šæ•°ä»»åŠ¡åœ¨ç»è¿‡è°ƒæ•´åŽçš„æ•´ä½“æ”¹è¿›ï¼Œä½†æœ‰ä¸€äº›æƒ…å†µä¸‹æŸäº›ä»»åŠ¡çš„è¡¨çŽ°æœ‰æ‰€ä¸‹é™ã€‚

çŸ¥è¯†ï¼šè§‚å¯Ÿåˆ°åŸºç¡€æ¨¡åž‹å’ŒèŠå¤©æ¨¡åž‹åœ¨çŸ¥è¯†ç›¸å…³ä»»åŠ¡ï¼ˆå¦‚TriviaQAã€MMLUå’ŒC-Evalï¼‰ä¸Šçš„è¡¨çŽ°å­˜åœ¨æ³¢åŠ¨ã€‚ç„¶è€Œï¼Œä½œè€…å¹¶ä¸è®¤ä¸ºè¿™äº›è½»å¾®çš„æ³¢åŠ¨è¡¨æ˜Žåœ¨SFTä¹‹åŽèŽ·å¾—äº†æˆ–å¤±åŽ»äº†çŸ¥è¯†ã€‚SFTçš„ä»·å€¼åœ¨äºŽå®ƒèƒ½å¤Ÿåœ¨èŠå¤©æ¨¡åž‹çš„é›¶æ ·æœ¬è®¾ç½®ä¸­å­¦ä¹ è¾¾åˆ°ä¸ŽåŸºç¡€æ¨¡åž‹å°‘æ ·æœ¬è®¾ç½®ç›¸å½“çš„åˆ†æ•°ï¼Œè¿™ä¸ŽçœŸå®žåœºæ™¯æ˜¯ä¸€è‡´çš„ã€‚ä¾‹å¦‚ï¼ŒèŠå¤©æ¨¡åž‹çš„é›¶æ ·æœ¬MMLUæ€§èƒ½ä¸ŽåŸºç¡€æ¨¡åž‹çš„5æ ·æœ¬MMLUæ€§èƒ½ç›¸å½“ã€‚

æŽ¨ç†ï¼šç”±äºŽSFTå®žä¾‹ä¸­æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†é‡‡ç”¨çš„CoTæ ¼å¼ï¼ŒèŠå¤©æ¨¡åž‹åœ¨æŽ¨ç†ä»»åŠ¡ï¼ˆå¦‚BBHå’ŒNaturalQuestionsï¼‰ä¸Šè¡¨çŽ°å‡ºè½»å¾®çš„æ”¹è¿›ã€‚ç„¶è€Œï¼Œä½œè€…è®¤ä¸ºSFTé˜¶æ®µå¹¶æ²¡æœ‰å­¦ä¹ æŽ¨ç†èƒ½åŠ›ï¼Œè€Œæ˜¯å­¦ä¹ æŽ¨ç†è·¯å¾„çš„æ­£ç¡®æ ¼å¼ã€‚

æ€§èƒ½ä¸‹é™çš„ä»»åŠ¡ï¼šåœ¨å¾®è°ƒåŽï¼ŒæŸäº›ä»»åŠ¡çš„æ€§èƒ½æŒç»­ä¸‹é™ï¼Œæ— è®ºæ¨¡åž‹å¤§å°æˆ–é€‰æ‹©çš„é¢„è®­ç»ƒæ£€æŸ¥ç‚¹å¦‚ä½•ã€‚è¿™äº›ç‰¹å®šä»»åŠ¡é€šå¸¸æ¶‰åŠclozeï¼ˆå®Œå½¢å¡«ç©ºï¼‰ä»»åŠ¡æˆ–å¥å­å®Œæˆä»»åŠ¡ï¼Œå¦‚HellaSwagã€‚å¯ä»¥åˆç†åœ°å‡è®¾çº¯è¯­è¨€æ¨¡åž‹æ›´é€‚åˆå¤„ç†æ­¤ç±»ä»»åŠ¡ã€‚

æ•°å­¦å’Œä»£ç ï¼šæ¨¡åž‹åœ¨æ•°å­¦å’Œç¼–ç¨‹ä»»åŠ¡ä¸Šçš„è¡¨çŽ°ç»è¿‡å¾®è°ƒåŽæœ‰äº†æ˜¾è‘—æ”¹å–„ã€‚ä¾‹å¦‚ï¼ŒHumanEvalå’ŒGSM8Kå¾—åˆ†æé«˜äº†20å¤šåˆ†ã€‚åŽŸå› å¯èƒ½æ˜¯ï¼ŒåŸºç¡€æ¨¡åž‹æœ€åˆå¯¹è¿™äº›ä»»åŠ¡è¿›è¡Œäº†æ¬ æ‹Ÿåˆï¼Œè€ŒSFTé˜¶æ®µé€šè¿‡å¹¿æ³›çš„SFTæ•°æ®å­¦ä¹ äº†ç¼–ç å’Œæ•°å­¦æ–¹é¢çš„é¢å¤–çŸ¥è¯†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¨¡åž‹çš„æŠ€èƒ½å¯èƒ½ä¸»è¦é›†ä¸­åœ¨ä»£ç å®Œæˆå’Œä»£æ•°é—®é¢˜ä¸Šã€‚ä¸ºäº†å…¨é¢äº†è§£æ•°å­¦å’Œç¼–ç¨‹ï¼Œåœ¨é¢„è®­ç»ƒé˜¶æ®µèžå…¥å„ç§æ•°æ®è‡³å…³é‡è¦ï¼Œè¿™ç•™ä½œæœªæ¥çš„å·¥ä½œã€‚

åœ¨7Bæ¨¡åž‹çš„å¾®è°ƒä¸­ï¼Œæœ€åˆä½¿ç”¨æ‰€æœ‰æ•°æ®å¯¹æ¨¡åž‹è¿›è¡Œå¾®è°ƒï¼ŒéšåŽå¼•å…¥äº†ç¬¬äºŒé˜¶æ®µï¼ŒæŽ’é™¤äº†æ•°å­¦å’Œä»£ç æ•°æ®ã€‚å¯¹äºŽ67Bæ¨¡åž‹åªè¿›è¡Œäº†ä¸€é˜¶æ®µçš„SFTã€‚

### å¼€æ”¾å¼è¯„ä¼°

ä¸ºäº†è¯„ä¼°èŠå¤©æ¨¡åž‹çš„æ•ˆæžœï¼Œé™¤äº†æ ‡å‡†åŸºå‡†çš„è¯„ä¼°æŒ‡æ ‡ä¹‹å¤–ï¼Œè¿˜éœ€è¦è€ƒè™‘å…¶åœ¨å¼€æ”¾é¢†åŸŸå’Œå¼€æ”¾å¼é—®é¢˜ä¸­çš„è¡¨çŽ°ï¼Œå› ä¸ºè¿™ç›´æŽ¥å½±å“åˆ°ç”¨æˆ·çš„å®žé™…ä½“éªŒã€‚å› æ­¤ï¼Œåˆ†åˆ«æµ‹è¯•äº†ä¸­æ–‡å’Œè‹±æ–‡ä»»åŠ¡ä¸­èŠå¤©æ¨¡åž‹çš„å¼€æ”¾å¼ç”Ÿæˆèƒ½åŠ›ã€‚

#### ä¸­æ–‡å¼€æ”¾å¼è¯„ä¼°

å¯¹äºŽä¸­æ–‡å¼€æ”¾å¼è¯„ä¼°ï¼Œåœ¨é«˜è´¨é‡çš„å¼€æ”¾å¼é—®é¢˜æµ‹è¯•é›†AlignBenchä¸Šæµ‹è¯•äº†æˆ‘ä»¬çš„èŠå¤©æ¨¡åž‹åœ¨ä¸åŒé¢†åŸŸçš„è¡¨çŽ°ã€‚AlignBenchåŒ…å«8ä¸ªä¸»è¦ç±»åˆ«ã€36ä¸ªæ¬¡è¦ç±»åˆ«ï¼Œå…±æœ‰683ä¸ªé—®é¢˜ã€‚å¯¹äºŽæ¯ä¸ªé—®é¢˜ï¼Œé™¤äº†æç¤ºå¤–ï¼ŒAlignBenchè¿˜æä¾›äº†ä¸“ä¸šå‚è€ƒç­”æ¡ˆå’Œè¯„çº§æ¨¡æ¿ä¾›GPT-4è¯„åˆ¤å›žå¤è´¨é‡ã€‚

åˆ©ç”¨å®˜æ–¹AlignBenchçš„GitHubä»£ç åº“å®žçŽ°äº†å¯¹æ¨¡åž‹çš„è¯„ä¼°ã€‚ä¸¥æ ¼å°†å…³é”®æ¸©åº¦å‚æ•°ä¸ŽåŽŸå§‹è®¾ç½®å¯¹é½ï¼šå¯¹äºŽè§’è‰²æ‰®æ¼”ã€å†™ä½œèƒ½åŠ›å’Œå¼€æ”¾å¼é—®é¢˜ï¼Œç”Ÿæˆæ¸©åº¦è®¾ç½®ä¸º0.7ï¼›è€Œå¯¹äºŽå…¶ä»–ä»»åŠ¡ï¼Œç”Ÿæˆæ¸©åº¦è®¾ç½®ä¸º0.1ã€‚DeepSeek 67B Chatæ¨¡åž‹è¶…è¶Šäº†ChatGPTå’Œå…¶ä»–åŸºå‡†æ¨¡åž‹ï¼Œä¸ŽGPT-3.5ç›¸åª²ç¾Žã€‚

#### è‹±æ–‡å¼€æ”¾å¼è¯„ä¼°

å¯¹äºŽè‹±æ–‡å¼€æ”¾å¼è¯„ä¼°ï¼Œä½¿ç”¨äº†MT-BenchåŸºå‡†ï¼Œè¯¥åŸºå‡†åŒ…å«8ä¸ªä¸åŒç±»åˆ«çš„å¤šè½®é—®é¢˜ã€‚DeepSeek LLM 67B Chatåœ¨å¤šè½®å¯¹è¯æ–¹é¢è¶…è¿‡äº†å…¶ä»–å¼€æºæ¨¡åž‹ï¼Œå¦‚LLaMA-2-Chat Touvronç­‰ã€Xwin 70b v0.1å’ŒTÃœLU 2+DPO 70Bï¼Œå¹¶å–å¾—äº†8.35åˆ†çš„æˆç»©ï¼Œä¸ŽGPT-3.5-turboç›¸å½“ã€‚æ­¤å¤–ï¼Œç»è¿‡DPOé˜¶æ®µåŽï¼ŒDeepSeek LLM 67B Chat DPOè¿›ä¸€æ­¥æé«˜äº†å¹³å‡åˆ†æ•°è‡³8.76åˆ†ï¼Œä»…æ¬¡äºŽGPT-4ã€‚è¿™äº›ç»“æžœè¡¨æ˜ŽDeepSeek LLMå…·æœ‰å¼ºå¤§çš„å¤šè½®å¼€æ”¾å¼ç”Ÿæˆèƒ½åŠ›ã€‚

#### held-outè¯„ä¼°

åœ¨è¯„ä¼°LLMï¼ˆå¤§è¯­è¨€æ¨¡åž‹ï¼‰æ—¶ï¼Œæ•°æ®æ±¡æŸ“å’ŒåŸºå‡†è¿‡æ‹Ÿåˆæ˜¯ä¸¤ä¸ªæŒ‘æˆ˜ã€‚ä¸€ç§å¸¸è§çš„åšæ³•æ˜¯åˆ©ç”¨æœ€è¿‘å‘å¸ƒçš„æµ‹è¯•é›†ä½œä¸º held-out æµ‹è¯•é›†æ¥è¯„ä¼°æ¨¡åž‹ã€‚

DeepSeek 7B å’Œ 67B æ¨¡åž‹ä½¿ç”¨ç›¸åŒçš„è®­ç»ƒç®¡é“ï¼Œä½†å®ƒä»¬çš„æ€§èƒ½å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚é€šè¿‡ä¸»è§‚è¯„ä¼°ï¼Œå‘çŽ°åœ¨å°†æ¨¡åž‹è§„æ¨¡æ‰©å±•åˆ° 67B æ—¶ï¼Œå®ƒåœ¨å„é¡¹ä»»åŠ¡ä¸Šçš„æ™ºèƒ½æ°´å¹³å­˜åœ¨æ˜Žæ˜¾å·®å¼‚ã€‚è™½ç„¶ DeepSeek 7B åœ¨æ ‡å‡†åŸºå‡†æµ‹è¯•ä¸­è½åŽäºŽå…¶ä»–å°åž‹è¯­è¨€æ¨¡åž‹ï¼Œä½†åœ¨ held-out ä»»åŠ¡ä¸Šçš„è¡¨çŽ°ä¸Žå…¶ä»–æ¨¡åž‹ç›¸æ¯”ç›¸å¯¹ä»¤äººæ»¡æ„ã€‚

#### Safety Evaluation

åœ¨æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒåŒ…æ‹¬é¢„è®­ç»ƒã€SFTå’ŒDPOé˜¶æ®µï¼Œéƒ½èžå…¥äº†æ¨¡åž‹å®‰å…¨æ€§çš„ä¿éšœã€‚ä¸ºäº†éªŒè¯æ¨¡åž‹çš„å®‰å…¨æ€§ï¼Œdeepseekæˆç«‹äº†ä¸€ä¸ªç”±20äººç»„æˆçš„ä¸“å®¶å›¢é˜Ÿï¼Œä»–ä»¬æ¥è‡ªä¸åŒçš„é¢†åŸŸå’ŒèƒŒæ™¯ï¼Œå…±åŒè´Ÿè´£è¯„ä¼°å’Œç›‘æµ‹æ¨¡åž‹çš„å®‰å…¨æ€§ã€‚

åœ¨è®¾è®¡é—®é¢˜æ—¶ï¼Œä¸“å®¶å›¢é˜Ÿè¿˜æ³¨é‡æŸ¥è¯¢æ–¹å¼çš„å¤šæ ·æ€§ã€‚ä»–ä»¬é€šè¿‡è¯±å¯¼ã€è§’è‰²æ‰®æ¼”ã€å¤šè½®å¯¹è¯ã€é¢„è®¾ç«‹åœºç­‰æ–¹å¼æž„å»ºäº†å¤šæ ·åŒ–çš„å®‰å…¨é—®é¢˜ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬èŽ·å¾—äº†ä¸€ä¸ªåŒ…å«2400ä¸ªé—®é¢˜çš„å®‰å…¨æµ‹è¯•é›†ã€‚æ­¤å¤–ï¼Œä¸“å®¶å›¢é˜Ÿè¿˜é’ˆå¯¹æ¯ç§ä¸åŒçš„å†…å®¹ç±»åž‹å’Œæ ¼å¼ç±»åž‹åˆ¶å®šäº†åŸºæœ¬çš„å®‰å…¨å®¡æ ¸å‡†åˆ™ã€‚

![security-evaluation](./pics/deepseek-llm-security-evaluation.jpg)

æ ‡æ³¨è€…å¯¹æ¯ä¸ªé—®é¢˜è¿›è¡Œäº†ä¸‰ä¸ªç±»åˆ«çš„æ ‡æ³¨ï¼šå®‰å…¨ã€ä¸å®‰å…¨å’Œæ¨¡åž‹æ‹’ç»ã€‚ä½œè€…å¯¹DeepSeek 67B Chatæ¨¡åž‹è¿›è¡Œäº†å®‰å…¨æµ‹è¯•ï¼Œç»“æžœå¦‚è¡¨10æ‰€ç¤ºã€‚è¡¨æ ¼ä¸­åˆ—å‡ºäº†æ¯ä¸ªå®‰å…¨ç±»åˆ«çš„æµ‹è¯•é—®é¢˜æ•°é‡ä»¥åŠæ¨¡åž‹é€šè¿‡çš„å®‰å…¨æµ‹è¯•æ•°é‡ã€‚æˆ‘ä»¬å°†å®‰å…¨å›žç­”å’Œæ¨¡åž‹æ‹’ç»çš„æµ‹è¯•ç”¨ä¾‹æ ‡è®°ä¸ºå®‰å…¨å“åº”ã€‚ç»“æžœè¡¨æ˜Žï¼Œæ¨¡åž‹åœ¨å¤šä¸ªå®‰å…¨æµ‹è¯•ç±»åˆ«ä¸­è¡¨çŽ°å‡ºè‰¯å¥½çš„å®‰å…¨æ€§ã€‚

ä½¿ç”¨â€œDo-Not-Answerâ€æ•°æ®é›†æ¥è¯„ä¼°DeepSeek 67B Chatæ¨¡åž‹çš„å®‰å…¨æœºåˆ¶ã€‚è¯¥æ•°æ®é›†çš„939ä¸ªé£Žé™©åˆ†ç±»æç¤ºæœ‰åŠ©äºŽçªå‡ºæ¨¡åž‹çš„å¢žå¼ºèƒ½åŠ›ã€‚å¦‚è¡¨11æ‰€ç¤ºï¼ŒDeepSeek 67B Chatæ¨¡åž‹å¾—åˆ†ä¸º97.8ï¼Œé«˜äºŽChatGPTå’ŒGPT-4ã€‚

## 6. ç»“è®º

è®ºæ–‡ä»‹ç»äº†DeepSeek LLMsï¼Œè¿™æ˜¯ä¸€ç³»åˆ—åœ¨2ä¸‡äº¿æ ‡è®°çš„è‹±è¯­å’Œä¸­æ–‡å¤§åž‹æ•°æ®é›†ä¸Šä»Žå¤´å¼€å§‹è®­ç»ƒçš„å¼€æºæ¨¡åž‹ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæ·±å…¥è§£é‡Šäº†è¶…å‚æ•°é€‰æ‹©ã€æ‰©å±•å®šå¾‹ä»¥åŠåšè¿‡çš„å„ç§å¾®è°ƒå°è¯•ã€‚æ ¡å‡†äº†å…ˆå‰å·¥ä½œä¸­çš„æ‰©å±•å®šå¾‹ï¼Œå¹¶æå‡ºäº†æ–°çš„æœ€ä¼˜æ¨¡åž‹/æ•°æ®æ‰©å±•-ç¼©æ”¾åˆ†é…ç­–ç•¥ã€‚æ­¤å¤–ï¼Œè¿˜æå‡ºäº†ä¸€ç§æ–¹æ³•ï¼Œä½¿ç”¨ç»™å®šçš„è®¡ç®—é¢„ç®—æ¥é¢„æµ‹è¿‘ä¼¼çš„batch-sizeå’Œlearning-rateã€‚è¿›ä¸€æ­¥å¾—å‡ºç»“è®ºï¼Œæ‰©å±•å®šå¾‹ä¸Žæ•°æ®è´¨é‡æœ‰å…³ï¼Œè¿™å¯èƒ½æ˜¯ä¸åŒå·¥ä½œä¸­ä¸åŒæ‰©å±•è¡Œä¸ºçš„åŽŸå› ã€‚åœ¨æ‰©å±•å®šå¾‹çš„æŒ‡å¯¼ä¸‹ï¼Œä½¿ç”¨æœ€ä½³è¶…å‚æ•°è¿›è¡Œé¢„è®­ç»ƒï¼Œå¹¶è¿›è¡Œå…¨é¢è¯„ä¼°ã€‚

DeepSeek Chatä¸Žå…¶ä»–LLMsä¸€æ ·å­˜åœ¨å…¬è®¤çš„å±€é™æ€§ï¼ŒåŒ…æ‹¬é¢„è®­ç»ƒåŽç¼ºä¹æŒç»­çš„çŸ¥è¯†æ›´æ–°ã€å¯èƒ½ç”Ÿæˆéžäº‹å®žä¿¡æ¯ä»¥åŠäº§ç”Ÿå¹»è§‰çš„å€¾å‘ã€‚æ­¤å¤–ï¼Œä¸­æ–‡æ•°æ®åˆå§‹ç‰ˆæœ¬å¹¶ä¸è¯¦å°½ï¼Œè¿™å¯èƒ½å¯¼è‡´åœ¨æŸäº›ç‰¹å®šä¸­æ–‡ä¸»é¢˜ä¸Šçš„æ€§èƒ½ä¸ä½³ã€‚ç”±äºŽæ•°æ®ä¸»è¦ç”±ä¸­æ–‡å’Œè‹±æ–‡æ¥æºç»„æˆï¼Œå› æ­¤æ¨¡åž‹åœ¨å…¶ä»–è¯­è¨€çš„ç†Ÿç»ƒç¨‹åº¦ä¸ä½³ã€‚

- ä¸ä¹…åŽï¼ŒDeepSeek å°†åˆ†åˆ«å‘å¸ƒå…³äºŽä»£ç æ–¹é¢ä»¥åŠMixture-of-Expertsï¼ˆMoEï¼‰çš„æŠ€æœ¯æŠ¥å‘Šã€‚å®ƒä»¬å°†å±•ç¤ºå¦‚ä½•ä¸ºé¢„è®­ç»ƒåˆ›å»ºé«˜è´¨é‡çš„ä»£ç æ•°æ®ï¼Œå¹¶è®¾è®¡ç¨€ç–æ¨¡åž‹ä»¥å®žçŽ°å¯†é›†æ¨¡åž‹çš„æ€§èƒ½ã€‚
- ç›®å‰ï¼Œæ­£åœ¨ä¸ºå³å°†åˆ°æ¥çš„DeepSeek LLMç‰ˆæœ¬æž„å»ºæ›´å¤§ã€æ›´å®Œå–„çš„æ•°æ®é›†ã€‚å¸Œæœ›ä¸‹ä¸€ç‰ˆåœ¨æŽ¨ç†ã€ä¸­æ–‡çŸ¥è¯†ã€æ•°å­¦å’Œä»£ç èƒ½åŠ›æ–¹é¢æœ‰æ˜¾è‘—æå‡ã€‚
- DeepSeek å¯¹é½å›¢é˜Ÿè‡´åŠ›äºŽç ”ç©¶å¦‚ä½•å‘å…¬ä¼—æä¾›æœ‰å¸®åŠ©ã€è¯šå®žå’Œå®‰å…¨çš„æ¨¡åž‹ã€‚åˆæ­¥å®žéªŒè¯æ˜Žï¼Œå¼ºåŒ–å­¦ä¹ å¯ä»¥æå‡æ¨¡åž‹çš„å¤æ‚æŽ¨ç†èƒ½åŠ›ã€‚


> refer to: https://zhuanlan.zhihu.com/p/680557770
